

<page-source>

      <template shadowrootmode=open>
      
            <style>
            
  #root
    {display:inline;font-family:arial}
    
  #btn
    {display:inline-block;border:1px solid lightgray;background:whitesmoke;border-radius:5px;padding:5px 10px;cursor:pointer}
    
  #hldr
    {position:fixed;top:50px;width:1800px;max-width:calc(100% - 50px);right:10px;max-height:calc(100vh - 100px);
      border:2px solid cyan;padding:5px;background:white;overflow:auto;z-index:9999;
      display:none;flex-direction:column;gap:10px;box-siing:border-box;left:10px;margin:auto}
      
  #hdr
    {display:flex;gap:10px;position:relative;height:7px}
  #label
    {position:absolute;top:-5px;right:-1px;font-style:italic;color:gray;font-weight:bold}
  #label span
    {vertical-align:middle;background white;border:1px solid lightgray;padding:1px;cursor:pointer;border-radius:5px;z-index:1}
    
  #close
    {width:16px;height:16px;margin-left:5px;vertical-align:middle}
    
  web-editor
    {flex:1}
    
  .spc
    {flex:1}
    
            </style>
            
            <div id=root>
            
                  <span id=btn>
                        page source
                  </span>
                  
                  <div id=hldr>
                  
                        <div id=hdr>
                              <div id=label>
                                    <span>
                                          page source
                                    </span>
                                    <img id=close src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeBAMAAADJHrORAAAAKlBMVEVHcEz+Bwf4Dg7ZREb4Dw+9bHD8DAz3Dg/2EhP3Dg/2Dg/1FRb/BQb8EBHQoUjyAAAADHRSTlMA9WoCcQHwW2JXU1fvr9+zAAAA8klEQVQY042RMQ6CQBBFNyGGWEqIFRZqMLEjuBcgeABC4gGgUSMmVsQTmHgBD2DhPWioxpbKvYt/dnETK6Vg+Mxj5/9BiN/XPdLFWRo5LFJd5fika00+A05CW5ZuRQ0DMqCWgVoRA06CeoC+KKW6VMgJ6g46rgjAKiFFzRx6MIVu1gHuXsYH5vw44pehnqcBsu0esG0GnphFZfYJkPOsLrSBZPAiY9IES/T3fmTb5rz0q20Baf2ktt3MAvjXgDxiWLmBB44pxAKz2hAm4cmDfhjnDqfY8zor4zzu9yVuJhgAvU/hFsZ53O9bnPv/cf3j370BsAp+fLUPphoAAAAASUVORK5CYII='>
                              </div>
                        </div>
                        
                        <snippet-editor component fullsize mode=html></snippet-editor>
                        
                  </div>
                  
            </div>
            
      </template>
      
      <script>
      
(function({mod,host}){

  var obj   = {};
  
        var df=false,did='page-source';
        
        
        
        obj.initmod   = function(params){
        }//initmod
        
        
  //vars:-
  
        var page    = {
              source    : '',
              url       : ''
        };
        
        
        var shadow    = host.shadowRoot;
        var snippet;
        var editor;
        
        var status    = false;
        
        var btn   = {};
        
        
  //:
  
  
        obj.init    = async function(){
                                                                                debug('init');
              await mod.auto();
              
              snippet   = mod['snippet-editor'];
              editor    = snippet.editor;
              editor.filename(page.url);
              
              var url   = window.location.toString();
              var base    = document.querySelector('base');
              if(base){
                    url   = base.href;
              }
              page.url    = url;
              
        }//init
        
        
  //:
  
  
        obj.initdom   = function(){
                                                                                debug('initdom');
              $('#btn').onclick     = btn.open;
              $('#label').onclick   = btn.close;
              
              hldr    = $('#hldr');
              
        }//initdom
        
        
  //:
  
  
        btn.open    = async function(){
        
              if(status){
                    btn.close();
                    return;
              }
              
              hldr.style.display    = 'flex';
              if(!page.source){
                    page.source    = await fetch(page.url).then(res=>res.text());
              }
              editor.setvalue(page.source);
              
              status    = true;
              
        }//open
        
        
        btn.close   = function(){
        
              hldr.style.display    = '';
              
              status    = false;
              
        }//close
        
        
  //:
  
  
        obj.url   = function(url){
                                                                                debug('url',url);
              page.url    = url;
              editor.filename(url);
              
        }//url
        
        
  //:
  
  
        function $(root,css){return (!css && (css=root,root=shadow),root.querySelector(css))}
        
        
        function debug(...args){
        
              if(!df && !obj.df)return;
              args.unshift(`[ ${did} ]`);
              var fmt     = Array.from({length:args.length}).fill('%O').join(' ');
              var args2   = [fmt].concat(args);
              console.groupCollapsed.apply(console,args2);
              console.trace();
              console.groupEnd();
              
        }//debug
        
        
  return obj;
  
//page-source
})

      </script>
      
</page-source>


