

<page-source>

      <template shadowrootmode=open>
      
            <style>
            
  #root
    {display:inline;font-family:arial}
    
  #btn
    {display:inline-block;border:1px solid lightgray;background:whitesmoke;border-radius:5px;padding:5px 10px;cursor:pointer}
    
  #hldr
    {position:fixed;top:50px;left:10;right:10;
      border:2px solid cyan;padding:5px;background:white;
      display:none;flex-direction:column;gap:10px}
      
  #hdr
    {display:flex;gap:10px;position:relative;height:7px}
  #label
    {position:absolute;top:-5px;right:-1px;font-style:italic;color:gray;font-weight:bold}
    
  #close
    {width:30px;height:30px;border:1px solid lightgray;padding:2px;cursor:pointer}
    
  web-editor
    {flex:1}
    
  .spc
    {flex:1}
    
            </style>
            
            <div id=root>
            
                  <span id=btn>
                        page source
                  </span>
                  
                  <div id=hldr>
                  
                        <div id=hdr>
                              <div id=label>
                                    page source
                              </div>
                              <!--
                              <img id=close src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAA1VBMVEVHcEz+doTfPlDeP1H6d4XnPU7xPVDZNUWysrKzs7Ozs7PugY/4PlH8PE/xe4riO034PlGzs7P8RFbVNUWysrL6d4Wzs7Ozs7Ozs7P1eYf6PVD5PlDWNESdtLnwQVP4PlH5PlHUNUTVNESzs7Ozs7Ozs7Ozs7Ozs7P5eIb5eIX5d4X5d4XUNUX5ann4ZnWysrKzs7P5d4b8YXH8doT4d4X7d4X7V2f2cX/+PE/YM0P8O06zs7P9P1H2Ok3bNET9X27pN0j9TF7mNkf+dILuOEr9cYD8W2vp0/H6AAAAOHRSTlMA/g4IiyBXnAjC9ghu+hAqiLj9iQSdnkF9HMe2xgEXm5xpoallHNnoYHStpniJiSwtafPqUrjuR77IvIAAAAEuSURBVCjPzdLbVoJAFAZg9oDIUcUIMCXzrJ3PzUygEtb7P1IzA60G8LKL/htY62PD5gdF+QcZrJ/t4kzV9fOGXmpXmnC159Jhq66buCOcKca46oOXpzdH34Bm27d9zDOU7/8A8Oq6jwCaBhkV7ki8BtglNNkBQF4w1SXunEIuPGcHoWOkVF3MZ1mCaZrSC1RdnfsXm6KY7rekjeovzvyzzx+bHlPF1n75RK2regM/W32Qhqu9frnVMedNFltt97TpuiuaSglL6XItjlB8INOp8AMhE4lbZ8V0G6E288OWjCqfrMtddMWdkFG3ujrzsmfudWXuOGVXaHLd+vufNfYNFj9ugL8I51Ew8zzT9LxZEM3DhS/xvWm9V2KZdxIbYRSYy5XFLrKs1dIMotAQ8A0+9DpF6wyY7gAAAABJRU5ErkJggg=='>
                              -->
                        </div>
                        
                        <web-editor component fullsize mode=html></web-editor>
                        
                  </div>
                  
            </div>
            
      </template>
      
      <script>
      
(function({mod,host}){

  var obj   = {};
  
        var df=false,did='page-source';
        
        
        
        obj.initmod   = function(params){
        }//initmod
        
        
  //vars:-
  
        var page    = {
              source    : '',
              url       : window===window.top ? window.location.toString() : 'https://libs.ext-code.com/html/page-source/examples/page-source-example.html'
        };
        
        
        var shadow    = host.shadowRoot;
        var editor;
        
        var status    = false;
        
        var btn   = {};
        
        
  //:
  
  
        obj.init    = async function(){
                                                                                debug('init');
              await mod.auto();
              
              editor    = mod['web-editor'];
              editor.filename(page.url);
              
              
        }//init
        
        
  //:
  
  
        obj.initdom   = function(){
                                                                                debug('initdom');
              $('#btn').onclick     = btn.open;
              //$('#close').onclick   = btn.close;
              
              hldr    = $('#hldr');
              
        }//initdom
        
        
  //:
  
  
        btn.open    = async function(){
        
              if(status){
                    btn.close();
                    return;
              }
              
              hldr.style.display    = 'flex';
              if(!page.source){
                    page.source    = await fetch(page.url).then(res=>res.text());
              }
              editor.setvalue(page.source);
              
              status    = true;
              
        }//open
        
        
        btn.close   = function(){
        
              hldr.style.display    = '';
              
              status    = false;
              
        }//close
        
        
  //:
  
  
        obj.url   = function(url){
                                                                                debug('url',url);
              page.url    = url;
              editor.filename(url);
              
        }//url
        
        
  //:
  
  
        function $(root,css){return (!css && (css=root,root=shadow),root.querySelector(css))}
        
        
        function debug(...args){
        
              if(!df && !obj.df)return;
              args.unshift(`[ ${did} ]`);
              var fmt     = Array.from({length:args.length}).fill('%O').join(' ');
              var args2   = [fmt].concat(args);
              console.groupCollapsed.apply(console,args2);
              console.trace();
              console.groupEnd();
              
        }//debug
        
        
  return obj;
  
//page-source
})

      </script>
      
</page-source>


