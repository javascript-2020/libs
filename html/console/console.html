


<console-root>

      <template shadowrootmode=open>
      
            <style>
            
  #console
    {border:1px solid lightgray;height:200px}
    
    
            </style>


            
            <div id=console>
            
            
            </div>


      
      </template>
      
      
      
      
      <script>
      

mod.console   = function(){
  
  var obj   = {};
  
  
        var ext,$,ace,store
        ;
        
        obj.initmod   = function(params){
          
              ext       = params.ext;
              $         = params.$;
              ace       = params.ace;
              store     = params.store;
              
        }//initmod
        
        
  //:

        var store       = {};
        store.console   = window.console;
  
        var console;
        var cons;
        
        
        var root;
        
        
        
        
  
  //:
  
  
        obj.init    = async function(){
          
          
              await libs();

              
        }//init
        
var style;

        async function libs(){
          
              var url         = 'javascript-2020:external:/TarVK/chromeConsole/console.js';
              [console]       = await ext.text.github(url);
              console         = eval(console);
              console.initmod({store});
              
              var url       = 'javascript-2020:external:main:TarVK/chromeConsole/console.css';
              var css       = await ext.text.github[url];
              style         = document.createElement('style');
              style.textContent   = css;
              
        }//libs


  //:
  
  
        obj.initdom   = function(rootnode){



              var host;
              if(rootnode.nodeName==='CONSOLE'){
                    host    = rootnode;
              }else{
                    host    = $.$(rootnode,'console-root');
              }
              root    = host.shadowRoot;
              root.append(style);

              //import_style(root);
              
              
              var node    = $(root,'#console');
              cons        = console.create(node);
              
              
              
              
        }//initdom





        function import_style(shadow){

              if(!import_style.ct){
                    import_style.ct   = 0;
              }
              import_style.ct++;
              if(import_style.ct>10){
                                                                      console.log('import_style timeout');
                    return;
              }

              
              var ids   = ['ace-tm','ace_editor\\.css','ace_scrollbar\\.css','error_marker\\.css',];
              var n     = ids.length;
              for(var i=0;i<n;i++){
              
                    var id      = ids[i];
                    var style   = $('#'+id);
                    if(!style){
                          setTimeout(import_style,500,shadow);
                          return;
                    }
                    
              }//for
              
              for(var i=0;i<n;i++){
              
                    var id      = ids[i];
                    var style   = $('#'+id);
                    var copy    = style.cloneNode(true);
                    shadow.append(copy);
              
              }//for
              
              
        }//style
        
        
        
  //:
  
  
  
/*


        obj.create    = function(root){
          
              cons    = console.create(root);
              return cons;
              
              
        }//create
  
  
*/



  
        obj.test    = function(){
          

              cons.log('helloworld');
              
              
              
        }//test



  
  
  return obj;
  
  
}//console


      </script>
      
      
</console-root>





