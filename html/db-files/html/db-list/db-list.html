

<db-list>

      <template shadowrootmode=open>
      
            <style>

  #icon
    { width:16px;height:16px;cursor:pointer;
      content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAASFBMVEVHcEwQJTcZLDoQJTcUKDkTJzgXKjkeLzwSJjgZKzo4Q0kQJTcQJTcTJzkRJTcRJTcbLDsRJTcWKTkQJDcVJzgSJjcTJjcVKDn+MVnaAAAAGHRSTlMA6xraao4zDJ0iA+XPe8apE7cr802FYUJstPSpAAABEUlEQVQoz32S27KDIAxFAwESLnJV+/9/etDToU6VrifHxYTsBAAAl+UD2cGJ4YAPhPQ6LXrWDzCKtVdmb44L3qUu2BAJcmAA2ktR9O0XX0Gi7h8txrZ9F1DCnDpjImJvs1oGKg9t/XacrTX4QahDU8F1DTE7aQfSDQ0mtIYvmNwNINfVwlxDzjDXWSOynGmnG7Pgd253ctES++Q2YSWngZYf7Y/JiWpLHBT7Kc5iWXwhoAuX1mwSotR5MKqVfuQmY35oW1orZpo7iUXNW7MjWBhcgvWxONi8lZoHl7G4rSVu/PyY+kDzhqjvK+lP0SU8Nk33heYS+8+XCItSu7pR2n6cWqMXD/i4/zdD1TxQj+v+AFoGEU8Y6sUpAAAAAElFTkSuQmCC);
    }
  .menu
    {position:absolute;left:-100px;text-align:left;font-weight:normal}
  #list
    {color:gray}
  .item
    {padding:5px 10px;white-space:nowrap}
  .del
    {cursor:pointer;width:16px;height:16px;
      content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAA81BMVEVHcEzpCg/oCg/rCxDqBw3jDxbxKi/hERjmDhXqCxHrCQ/wCQ/nDRPvCQ/tCxDuCxHsChDqCQ/rCQ/oChDqCxHvISbsCxHvCQ/wCA7////xBw7vCA3uEBX9+fn2dXnvjYz56ujrZGP2YWX4j5L67u30VVnzTFDxFRv2ZmryNTrrXV3uhob+/Pz2b3PyLzT5pqnwDBHxHCH2am72goX3en74i435lZfyOT70Q0f3f4L4hon5mZzyPUL6r7HsCw7hIh/1W17wIyj5oaPmDg7fGBXuwr3xzsr0t7b5nZ/sqKPtfHrmlI712dbXS0HaXlTWMSf13tvOkmlRAAAAGHRSTlMAkne4lBf+DSFghfk04szFomqmUEHzpu849HUcAAABlElEQVQoz3XT6XKCMBAA4GgV662t2iAKHgXEA4MXtCqKZz16vP/TNFmE0UH3TzJ87GZhsgixiL4mQpGrCCXiz8iLWD5TNGc0TNPUWOi6o6YTlxeiL5zYn8/n/f7qazqZNMefww+xoZNsCnJzs9XewybgSBR7LY1kWH6cmwZs0Go0ZANHaOns4I4tl7Ji4HQKFYpjOFCSLtZqLOt1WbF0gnEY5XXIO+1qe3FAE2XFHJ53PwuVKi6hsMZqHrc83923ZItTSf2d57cLzOIJhfXRSOz1djz1g0OwwJT/85nrsWYk9rAqVVytHm2fWaOy3KmB12HpVLDHDjVFsYw2QPVagRWKpooF8BtlbFjWTFPpXmizY/mu5CuwqelMH7Cqc4ard4urjkF8DbZWUSu+doMfRghNthVXg7+FVcbrg9eU62f/pwrAJ79l8O3mwvEkW+3fw847UGhv999r2JZQ4Q029mZhe58jbDau0usQy+JAlMvuSi/TpfrdiMBFfqRwkVE0R+6qOwYwRIEDkv4QwQiGQzfhjeA/5adn7RK0DWMAAAAASUVORK5CYII=);
      }
  .name
    {}
    
            </style>

            <img id=icon>
            
            <div class=menu style='display:none'>
            
                  <div class=menu-title>
                        dblist
                  </div>
                  
                  <div id=list>
                        <div class=item>
                              <img class=del>
                              <span class=name></span>
                        </div>
                  </div>
                  
            </div>

      </template>
      
      <script>
      
mod.dblist    = function(){
  
  var obj   = {};
  
        var $,grp,db
        ;
        
        obj.initmod   = function(params){
          
              $             = params.$;
              grp           = params.menu;
              db            = params.db;
              
        }//initmod
        
        
  //vars:-
  
  
        var root;
        var shadow;
        
        var list;
        var item;

        
  //:
  
  
        obj.init    = function(){
        }//init
        
        
  //:
  
  
        obj.initdom   = function(rootnode){
          
              root                                  = $.$(rootnode,'db-list');
              shadow                                = root.shadowRoot;

              grp.add.style(shadow);
              
              var card                              = $(shadow,'.menu');
              $(shadow,'#icon').onclick             = grp.click(card,false,false,menu);

              list                                  = $(card,'#list');
              item                                  = $(list,'.item');
              item.remove();
              
        }//initdom



  //:
  
  
        function menu(type,opt){
          
              switch(type){
                
                case 'show'   : show();       break;
                
              }//switch
              
        }//menu
        
        
  //:
  
  
        async function show(){
          
              list.replaceChildren();
              
              var names   = await db.list();
              names.forEach(name=>{
                
                    var nitem                       = item.cloneNode(true);
                    $(nitem,'.del').ondblclick      = del;
                    $(nitem,'.name').textContent    = name;
                    list.append(nitem);

                    
                    async function del(){
                      
                          await db.delete(name);
                          show();
                          
                    }//del
                                        
              });
                            
        }//show
        
        
        
        
        
  
  return obj;
  
}//dblist
      
      </script>
      
</db-list>


