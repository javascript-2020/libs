

<filemod-root style='display:inline-flex'>

      <template shadowrootmode=open>
      
            <style>
            </style>
            
            <localfile-api>
                  <script src='https://html-loader-dblv8aserliq.runkit.sh?localfile'></script>
            </localfile-api>

            <github-api>
                  <script src='https://html-loader-dblv8aserliq.runkit.sh?github'></script>
            </github-api>
            
            <button id=save>save</button>
            
            <img id=icon src='data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAt1BMVEVHcEwbmPYcgfMchvQbsfkay/wbtvkbnfccefMayfwbmfYch/QchvQbtfkbmfYa1P0ddfIcivQcl/Ycj/Ubp/gcmfYdbPEbrvkazPwcmfYbqfgayfwayPwbv/sbvvobsvkazPwbqvga0fwbvPobtvocjvUbofcbpvccfPMcgPMcgvMdafAdbfEckfUbtvka0PwcfPIaxvsbwfsbvPodb/EcnPYclvYckfUbpvccjPQdd/IbofcbrPiPy8D0AAAAMHRSTlMAA/79/v7+5ycVZ3Y3h0xhu9jp8kFeF9OkVfQOrZi+Mh1z/iUJQ+/dx4fOYq7hybzs5xU1AAABIklEQVQ4y+2Ux3aDMBBFpTR6M92AwYB7S6EG/v+7MsJJnBBKVsnGdwHozT1HQgxC6MrfEkiSM+Y4khSgUxhazLDHWGF4QveAO2gyLnGQ9QS4wcDaXGJYiPGegVnU50UzUvdgTsd7AfrMaEaqXvO+sfAAHP0uzz+SmhCfR7FwB5gdpm+SyoeHEJ5P67o2tbanmRBP5/iSgFkUxaplaisIv3kAu6yqihK/RiIF0ZJtT6NTaZpS9iWwm0D/uXB7kmXZ5LOgN0O7ayvEQ57nKtssCbMqDA5i9+YulLIsVQ5MzKnwqCz6Phev3AIcxhy5K3x/A/DbG2CzIdctP9RS9PrxnTU92KOYll8bZHqs7Wk5AcY9hIx9kuyN3/xuxm5nXA+df+cNJSAgjMbiFSoAAAAASUVORK5CYII='>
            
            <div class=menu style='display:none'>
                  <div id=editor class=menu-opt>editor</div>
                  <div id=js-console class=menu-opt>js console</div>
                  <div id=html-editor class=menu-opt>html-editor</div>
            </div>
            
            <checkbox-one id=autosave></checkbox-one>
            
      </template>
      
      <script>
      
            filemod   = filemod();
            
            function filemod(){
                                                                                console.log('filemod');
              var obj   = {};

            
                    var menumod
                    ;
                    
                    obj.initmod=function(params){
                      
                          menumod   = params.menumod;
                          
                    }//initmod

                    
                    var cur;

                    var autosave;

                    
                    var btn   = {};
                    
                    
                    obj.init=function(){
                    
                        localfile.load.complete   = (txt,path,icon)=>complete.load('localfile',txt,path,icon);
                        localfile.save.complete   = (path,icon)=>complete.save('localfile',path,icon);
                        
                        github.load.complete      = (txt,path,icon)=>complete.load('github',txt,path,icon);
                        github.save.complete      = (path,icon)=>complete.save('github',path,icon);
                        
                    }//init
                    
                    
                    obj.initdom=function(){
                    
                          root                          = $.full('filemod-root');
                          shadow                        = root.shadowRoot;

                          var style                     = $(shadow,'style');                          
                          $.stylesheet.insert(style,'button');

                          
                          localfile.initdom();
                          github.initdom();


                          $(shadow,'#save').onclick     = btn.save;

                          var card                      = $(shadow,'.menu');
                          $(shadow,'#icon').onclick     = menumod.click(card,false,false,menu);

                          autosave                      = $(shadow,'#autosave');
                          autosave.checked              = false;

                          
                    }//initdom
                    

                    btn.save=function(e){save()}
                    
                    
                    obj.save=function(){return save()}
                    
                    function save(){
                    
                          e.preventDefault();
                          
                          if(!cur){
                                log.orange('no file');
                                return;
                          }
                          
                          var txt   = editor.getValue();
                          
                          if(cur.type=='github'){
                                github.save(txt);
                          }
                          if(cur.type=='local'){
                                localfile.save();
                          }
                    
                    }//save
                    
              return obj;
              
            }//filemod
            
      </script>

</filemod-root>


