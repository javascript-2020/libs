

<filemod-root style='display:inline-flex'>

      <template shadowrootmode=open>
      
            <localfile-api>
                  <script src='https://html-loader-dblv8aserliq.runkit.sh?localfile'></script>
            </localfile-api>

            <github-api>
                  <script src='https://html-loader-dblv8aserliq.runkit.sh?github'></script>
            </github-api>
            
            <button id=save>save</button>
            <checkbox-one id=autosave></checkbox-one>
            
      </template>
      
      <script>
      
            filemod   = filemod();
            
            function filemod(){
                                                                                console.log('filemod');
              var obj   = {};

            
                    var menumod
                    ;
                    
                    obj.initmod=function(params){
                      
                          menumod   = params.menumod;
                          
                    }//initmod

                    
                    var cur;

                    var autosave;

                    
                    var btn   = {};
                    
                    
                    obj.init=function(){
                    
                        localfile.load.complete   = (txt,path,icon)=>complete.load('localfile',txt,path,icon);
                        localfile.save.complete   = (path,icon)=>complete.save('localfile',path,icon);
                        
                        github.load.complete      = (txt,path,icon)=>complete.load('github',txt,path,icon);
                        github.save.complete      = (path,icon)=>complete.save('github',path,icon);
                        
                    }//init
                    
                    
                    obj.initdom=function(){
                    
                          root                          = $.full('filemod-root');
                          shadow                        = root.shadowRoot;

                          var style                     = $(shadow,'style');                          
                          $.stylesheet.insert(style,'button');

                          
                          localfile.initdom();
                          github.initdom();


                          $(shadow,'#save').onclick     = btn.save;

                          var card                      = $(shadow,'.menu');
                          $(shadow,'#icon').onclick     = menumod.click(card,false,false,menu);

                          autosave                      = $(shadow,'#autosave');
                          autosave.checked              = false;

                          
                    }//initdom
                    

                    btn.save=function(e){save()}
                    
                    
                    obj.save=function(){return save()}
                    
                    function save(){
                    
                          e.preventDefault();
                          
                          if(!cur){
                                log.orange('no file');
                                return;
                          }
                          
                          var txt   = editor.getValue();
                          
                          if(cur.type=='github'){
                                github.save(txt);
                          }
                          if(cur.type=='local'){
                                localfile.save();
                          }
                    
                    }//save
                    
              return obj;
              
            }//filemod
            
      </script>

</filemod-root>


