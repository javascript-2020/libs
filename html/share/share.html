

<share-root>

      <template shadowrootmode=open>
      
            <button id=jsonblob style='margin-right:20px'>jsonblob</button>

      </template>
      
      <script>
      
            share   = share();
            
            function share(){
              
              var obj   = {};
              

                    var ui;
                    
                    
                    obj.initmod=function(params){
                      
                          ui    = params.ui;
                          
                    }//initmod

                                        
                    var mode    = 'jsonblob';
                    var jsonblob;

                    
                    var btn     = {};


                    obj.init=function(){return init()}
                    
                    function init(){

                          var resolve,init.complete=new Promise(res=>resolve=res);
                          ext.load.libs('js/io/jsonblob/jsonblob.js')
                            .then(result){
                                              
                                  [jsonblob]    = result;
                                  
                                  jsonblob      = jsonblob();
                                  
                                  resolve();
                                  
                            };

                          
                          
                    }//init
                    
                    
                    obj.initdom=function(rootnode){
                      
                          $(root,'button').onclick    = btn.share;
                          
                    }//initdom
                    

                    btn.share=function(e){
                      
                          switch(mode){
                            
                            case 'jsonblob'   : jsonblob.save();
                            
                          }//switch
                          
                    }//share
                    

                    obj.query=async function(){
                      
                          await init.complete;
                          
                          switch(mode){
                            
                            case 'jsonblob'   : var json    = await jsonblob.util.query();        break;
                            
                          }//switch
                            
                          if(json){
                                editor.setValue(json.txt,-1);
                                if(autorun.checked){
                                      run();
                                }
                          }
                          
                    }//load
                    

                    obj.save=function(){
                      
                          var json    = ui.read();
                          switch(mode){
                            
                            case 'jsonblob'   : jsonblob.util.save(json);       break;
                            
                          }//switch
                      
                    }//save
                    

                    obj.delete=function(){

                          switch(mode){
                            
                            case 'jsonblob'   : jsonblob.util.delete();       break;
                            
                          }//switch
                      
                    }//delete

                          
                    
              return obj;
              
            }//share
            
      </script>
      
</share-root>

