

<https-file>

      <template shadowrootmode=open>
      
            <style>
            
                  .menu
                        {position:absolute;outline:none;font-family:arial}
            
                  #url-root
                        {display:flex;gap:5px;align-items:center;margin-bottom:10px}
                  .paste
                        {margin-right:5px;padding:2px;width:24px;height:24px;border:1px solid gray;cursor:pointer;border-radius:3px;
                            content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAVlJREFUSEvtlj1ug0AQhcdIW6RLeiQy6XKElLRIlOlp6LmBlRsgtzTUOQAtcZMzpMpInAGlQSjRWl7LxrM/dlhZUbwtu/PNvH07zAIutBYX4oIzGBG/95MkIuezXHFOh6MoegqC4F0GEELAMAybWL+BG8GI+AwArypjRFTAgyLOSeAIHIbhjRDii5NHgcdxhK7rWHu4JnEEnt6ljK6AUxIRcfAPInq0mVYL/lwSrNa3UL7d2WKA3CvXw8vuKqzeMYKtxMmGK9ik2FVq+XQ2rVE5VSeXMpLNgLp3fZbUrlCVFAc/GaygbdvaioU4jrU9/W+CVUVc6U3TQJIkfio2geVV/C+pi6KAsiz9SN33PaRpyrrbu9R1XbPgLMv83bHJXHmeQ1VVp0tt6w6zN5DtqHMwynJJeAGbqkVEOefc2xTZ/+7Uq10CcgOh7pzz38kFPMce6zQ4B4SL8QNf7+YfCGbtNAAAAABJRU5ErkJggg==);
                        }
                  .copy {margin-left:5px;padding:2px;width:24px;height:24px;border:1px solid gray;cursor:pointer;border-radius:3px;
                          content:url(data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAABSlBMVEVHcEwnz/4C8P4g1P4L6P43wf5Mr/4a2v4Y3P4/uv5PrP4+vf5Auv4ozv5KsP4vyv45wP5Jsf5Auf49vP5Mrv4zxf44wf5Lr/46wP4h1P5Lr/46vv5Jsv4R5P5Hs/5Etv44wf5Hs/41w/4uyv47vv49vP5Ftf5GtP4c2f4rzP4tyv4m0f5Etv5Nrv4xxv4xxv4xx/4W3/5KsP5Mr/4/u/4uyv5Isv4K6f4l0f4qzv4W3/4V3/5Nrv5Mrv5Mrv5Mr/4W3v4e2P5BuP5Hsv4N5v4K6f4O5v42w/5Dt/4E7/4uyf4C8P4nz/4M5/4K6v4oz/4P5f4k0v4b2v5Gs/4E7v4I6/5Nrf4e1/4H7P4E7v5Auv5Dtv4sy/5Isv5GtP4wx/49vP4zxf47vv44wP42w/5LsP5Jsf4i1P4n0P4N5v4k0v4a2v4S4v4X3v6OfcqkAAAAVnRSTlMACo7CjQWN/VczjgIJMfIXJzHtjj5iVekR71Hvtz7CjelXjre2wiJj2PCFIWbR7+fEnXaodz3544/USfOC22Tm7CXOnqfUZ+/3VTV9bsTzqGDahpb2tyRB6bIAAAIDSURBVDjLrZVpV9pAFIYntdFiQkZsLCQECtJSlqAsFRBU3Kuta1sncYGuJEDt///aISkkkyHo6enzLTlP5s5758wNAC526pd3d1++/fzx/evNze1tp210wxURUMTWBz2v2EWtLc7jBTPmoJfNrqy8i0ajixgB00VISJIeW9JMKbcWDAYDNiFMQN1EqAAJcUfSBif0fsQWQjLxpjGnXUJa5CoIbTiP8KJ0OqfNMLQIZhGad/Ke3t///vWwGKv1+yPxfW55+TnmJWZW5ggxcqX3m6WSVTpSdPcxHCLExmf97AI8e1j8cK1f8X9Fq/Sotrf0k2v9KRiJ08L8mwhf2CQx8oK/yJyPw3Q67ULaV4Tr7tRCwFfkllLF4ushccwGPyUMzwzhMQz/X1Kz+QVMmh2LcjgsTxDZ3OpqIpFYfDu+KGwoxE5JvTtpF9NX9BEB792jn0gD4eNEsVAQHyXOO7fQFmNNLZOnPV5BqEyI+Yxm1qkluS0BCWRp8FEze6mTJQtVVd8MUfcEhBSGFOGMOWmaoc0AmRoXP5cmiHEReEXANOopzCsLRYlXjWolGXE2jK/r/ujEWAdOFIxWGrjO8ljXazG6MeynthEn2gAP9P7B4XCE2thzdG2v2jbK5LfHZ3hINbclSco6o/kIh1Einq4e1qxp5m2PkqZ/CPvbXvFot+xe7w/EpaiUrJ24NAAAAABJRU5ErkJggg==);
                        }
                        
                  #url
                        {flex:1}
                       
                  #btns
                        {display:flex}
                        
                        
                  #dir-root
                        {display:none}
                        
                  .spc
                        {flex:1}
                  input
                        {font-size:16px;padding:5px 10px}
                        
            </style>
            
            <img class=icon src='data:image/webp;base64,UklGRh4DAABXRUJQVlA4TBIDAAAvHUAHEIcFOZJkV1H2oDVH5b9NeMFNs/vGDTeOJClSVvUeM5v46fvieevNckNsJEmRFNXH+AaQ/8Yx8xfk2LZVRevd/3FnBimQCGkThEMAMHXrfi/A9XlzLs20QgUXKFCgdCroFT01mKLxkOlBkkoD2gk0DvCJkuAd+Yc15EjAG/lBpgpaBBT4hwItqKGShmQGAQuoIsswbTKH1NkWJAjoQw1NiAoreKI9uUyhA0jx/PHXraE8/xGoMKki1aSCErM81mGUUwzL/4lXYpbVQcWoQPUZncXyhAkKTp55EUT6Q44YI6/pLr7z54w3/wOoX7P2qNs8fX+/Ico70/U7VI7FBFbjiDAuFBHRj1p4Z+k3x/3K1EvEX7sn+bv/2Mat9Wkh1YNv+6+n2O23VpuNmBCT1b+IjjtEmTLz+YiIq4ejiRcm8x+ociy7S5Og2SrHFELFIEJQxYQY01mP/PVj5BMJqrPe5d+v5f7/1XA/MLJuvwtj/Pc3G6kvohTExAvlcEiUbNu0nf1s27Zt27YdvRcnL7Zt2843nrP2Pfv9wV7rKKL/DNy2jSPubrvtHUM7NzYxydGlQKPdyw6w38OasbIc/yAoILOTOTILSqne2LdXZa9XRUZHQTHphQwU13z23h3V3duHOto5bXmpSrNE8S2nbl4Hbty6cA46f6IpgdEslWf5NZ65ehm6Qpxrpxv8rHJGaS5LaycvXdRkWvqSLYlKPI+/ffNaAOrHPEvof33w/idPheiGJBxiEYufXjwTQPqiZIgU2/r1pUiGbEUlZeCoWEeUEcQ/9cFbj0WiLVlvIMIB4REw8OXVc02mBUbAwOEH9zWZZJeA/taHbD58pMnaRDKHEAwsfP7wEXj3HgFpLigjsKTK+VVg5cdPicB8ZSJfQXZ4mCrUaaBfDzVV4bKA619tMVBU6jU+gqVGMVBnc4dkDzeVu6vzwQPO0iCVh864MmoGp6dse+bX9rfv23LGtu3pQTPDQfk9fYreud275B4L+xR2voMqcr19VL6BCgv8AukVXGNdy0IMidw2KUTiziE='>

            <div id=httpsfile class=menu style='display:none;left:-225px;top:100px;width:450px'>
            
                  <div class=menu-title>
                        https file server
                  </div>
            
                  <div id=url-root>
                        <div>
                              url
                        </div>
                        <img class=copy>
                        <img class=paste>
                        <input id=url spellcheck=off autocomplete=false>
                  </div>
                  
                  <div id=btns>
                        <input value=load type=button>
                        <input value=save type=button>
                        <input value=dir type=button>
                        <div class=spc></div>
                        <input value=server type=button>
                  </div>
                  
                  <div id=dir-root>
                        <div id=dirs>
                              <div class=dir>
                                    <div class=name>
                                    </div>
                              </div>
                        </div>
                        <div id=files>
                              <div class=file>
                                    <div class=name>
                                    </div>
                              </div>
                        </div>
                  </div>
                  
            </div>
            
      </template>
      
      <script>
      
mod.httpsfile   = function(){
                                                                    true && console.log('httpsfile');
  var obj   = {};
      
        var df=obj.df=true;
        
        var menumod,$,editor
        ;
        
        obj.initmod   = function(params){
          
              menumod   = params.menumod;
              $         = params.$;
              editor    = params.editor;
              
        }//initmod
        
  //vars:-


        var root;
        var shadow;
        var icon;
        var ui          = {};
        ui.root         = {};
        ui.item         = {};


        var btn         = {};
        
  
  //
  
        obj.init    = function(){
        }//init

        
        obj.initdom   = function(rootnode){
          
              root                                  = $.$(rootnode,'https-file');
              shadow                                = root.shadowRoot;
              
              menumod.add.style(shadow);
              
              var style                             = $(shadow,'style');
              $.stylesheet.insert(style,'.icon');
              
              var node                              = $(shadow,'.menu');
              icon                                  = $(shadow,'.icon');
              icon.onclick                          = menumod.click(node,'both',true,callback);

              $(node,'.copy').onclick               = btn.copy;
              $(node,'.paste').onclick              = btn.paste;
              ui.url                                = $(node,'#url');
              
              $(node,'[value=load]').onclick        = btn.load;
              $(node,'[value=save]').onclick        = btn.save;
              $(node,'[value=dir]').onclick         = btn.dir;
              $(node,'[value=server]').onclick      = btn.server;


              ui.root.dir                           = $(node,'#dir-root');
              ui.root.dirs                          = $(ui.root.dir,'#dirs');
              ui.item.dir                           = $(ui.root.dirs,'.dir');
              ui.item.dir.remove();
              ui.root.files                         = $(ui.root.dir,'#files');
              ui.item.file                          = $(ui.root.files,'.file');
              ui.item.file.remove();
          
        }//initdom

        
  //:
  
  
        btn.copy    = async function(){
          
              var txt         = await navigator.clipboard.readText();
              ui.url.value    = txt;
              
        }//copy
        
        
        btn.paste   = async function(){
          
              var txt   = ui.url.value;
              await navigator.clipboard.writeText(txt);
              
        }//paste
  
  
        btn.load    = async function(){

              load();
              
        }//load
        
        
        btn.save    = async function(){
          
              save();
              
        }//save
        
        
        btn.server    = async function(e){
          
              if(e.shiftKey){
                    window.open('https://github.com/javascript-2020/libs/blob/main/nodejs/server/https-file-server/https-file-server.js','_blank');
                    return;
              }
          
              var res       = await fetch('https:/raw.githubusercontent/javascript-2020/libs/main/nodejs/server/https-file-server/https-file-server.js');
              var blob      = await res.blob();
              var url       = window.URL.createObjectURL(blob);
              
              var a         = document.createElement('a');
              a.download    = 'https-file-server.js';
              a.href        = url;
              a.click();
              
        }//server

        
  //:
  
  
        function callback(){
        }//callback
        

  //:
  
  
        obj.load    = function(){return load()}   //d
        
        async function load(url){
          
              var url         = ui.url.value;
              var i           = url.lastIndexOf('/');
              var filename    = url.slice(i+1);
                                                                                console.log(i,url,filename);
              var txt         = await loadfile(url);

              obj.load.complete(txt,filename,icon.src);
                      
        }//load
        
        
        obj.save    = function(){return save()}   //d
        
        async function save(){
        
              var txt         = editor.getValue();
              var url         = ui.url.value;
              var i           = url.lastIndexOf('/');
              var filename    = url.slice(i+1);
                                                                                console.log('save',url,filename);
              await savefile(txt,url);

              obj.save.complete(filename,icon.src);
              
        }//save
        
        
  //:
  
  
        async function loadfile(url){
          
              var headers     = {mode:'load'};
              var res         = await fetch(url,{headers});
              var txt         = await res.text();
              return txt;
              
        }//loadfile
        
        
        async function savefile(txt,url){
          
              var headers   = {mode:'save'};
              var body      = txt;
              var res       = await fetch(url,{method:'post',headers,body});
              var txt       = await res.text();
              return txt;
              
        }//save
        
        
        
  return obj;
      
}//httpsfile
            
      </script>
      
</https-file>